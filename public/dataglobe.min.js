/*! dataglobe 25-03-2015 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=React.createClass({legendItemStyle:{height:20,paddingBottom:5},toggleLinkStyle:{textDecoration:"none",fontWeight:"normal",WebkitTransition:"color 500ms ease-out",MozTransition:"color 500ms ease-out",OTransition:"color 500ms ease-out",transition:"color 500ms ease-out"},circleStyle:{display:"inline-block",width:15,height:15,borderRadius:"50%",marginTop:3,marginBottom:-2,WebkitTransition:"background-color 500ms ease-out",MozTransition:"background-color 500ms ease-out",OTransition:"background-color 500ms ease-out",transition:"background-color 500ms ease-out"},getInitialState:function(){return{active:!0}},handleLinkClick:function(a){var b;return a.preventDefault(),b=!this.state.active,this.setState({active:b}),this.props.clickCallback(this.props.type,b),!1},render:function(){var a;switch(a="",this.props.type){case"r":a="Red",this.circleStyle.backgroundColor="#ff1e00";break;case"o":a="Orange",this.circleStyle.backgroundColor="#ff7f00";break;case"g":a="Green",this.circleStyle.backgroundColor="#00ca35";break;case"b":a="Blue",this.circleStyle.backgroundColor="#008eaf";break;case"p":a="Purple",this.circleStyle.backgroundColor="#dc0068"}return this.state.active?this.toggleLinkStyle.color="#ddd":(this.toggleLinkStyle.color="#555",this.circleStyle.backgroundColor="#555"),React.createElement("li",{style:this.legendItemStyle,className:"series"},React.createElement("a",{style:this.toggleLinkStyle,onClick:this.handleLinkClick,href:"#"},React.createElement("div",{style:this.circleStyle})," - ",a))}})},{}],2:[function(a,b){var c;c=a("./legend-item"),b.exports=React.createClass({headerStyle:{fontSize:18,marginTop:0},listStyle:{listStyleType:"none",margin:0,padding:0},render:function(){var a;return a=this.props.clickCallback,React.createElement("div",null,React.createElement("h2",{style:this.headerStyle},"Legend"),React.createElement("ul",{style:this.listStyle},this.props.types.map(function(b){return React.createElement(c,{key:b,type:b,clickCallback:a})})))}})},{"./legend-item":1}],3:[function(a,b){var c;c=a("react-tween-state"),b.exports=React.createClass({mixins:[c.Mixin],getInitialState:function(){return{currVal:0}},canvasStyle:{display:"block"},strokeStyle:{radius:25,width:5,color:"#008EAF"},_canvas:null,_context:null,componentDidMount:function(){return this._canvas?void 0:(this._canvas=this.getDOMNode(),this._context=this._canvas.getContext("2d"),this._context.beginPath(),this._context.strokeStyle=this.strokeStyle.color,this._context.lineCap="square",this._context.closePath(),this._context.fill(),this._context.lineWidth=this.strokeStyle.width,this._context.globalAlpha=.33)},componentDidUpdate:function(){return this._updateProgress()},handleProgressUpdate:function(a){var b;return b=void 0,1===a&&(a=.99999,b=function(a){return function(){return a.tweenState("currVal",{endValue:0})}}(this)),this.tweenState("currVal",{endValue:a,onEnd:b})},_updateProgress:function(){var a;if(this._context)return this._context.clearRect(0,0,this._canvas.width,this._canvas.height),a=2*this.getTweeningValue("currVal")-.5,this._context.beginPath(),this._context.arc(this.strokeStyle.radius,this.strokeStyle.radius,this.strokeStyle.radius-this.strokeStyle.width,1.5*Math.PI,Math.PI*a,!1),this._context.stroke()},render:function(){return React.createElement("canvas",{style:this.canvasStyle,width:50,height:50})}})},{"react-tween-state":13}],4:[function(a,b){b.exports={COLOUR_MAP:{r:new THREE.Color(16719360),o:new THREE.Color(16744192),b:new THREE.Color(36527),g:new THREE.Color(51765),p:new THREE.Color(14418024)},COLOUR_TYPES:["r","o","b","g","p"],PARTICLE_SPEED:.22,NUM_TRAIL_PARTICLES:12,TRAIL_OPACITY_MULTIPLIER:.083,MESH_POOL_SIZE:100}},{}],5:[function(a,b){var c,d;d=a("./constants"),b.exports={loadWorldPins:function(a,b){return c(a,b)},loadCountryCodes:function(a,b){return c(a,b)},loadContentData:function(a){var b;return b=encodeURI("categories/All.json"),c(b,a)},loadRandomizedContentData:function(a,b,c){var e,f,g,h,i,j,k,l,m;for(m=[],i=Object.keys(b),h=g=0,k=a;k>=0?k>g:g>k;h=k>=0?++g:--g)l=Math.floor(Math.random()*i.length),f=Math.floor(Math.random()*i.length),e=d.COLOUR_TYPES[Math.floor(Math.random()*d.COLOUR_TYPES.length)],l===f&&(f=f===i.length-1?0:f+1),j={},j.src=b[i[l]],j.dest=b[i[f]],j.colour=e,m.push(j);return c(m)}},c=function(a,b){var c;return c=new XMLHttpRequest,c.open("GET",a,!0),c.onreadystatechange=function(){var a;return 4===c.readyState&&200===c.status&&(a=JSON.parse(c.responseText),b)?b(a):void 0},c.send(null)}},{"./constants":4}],6:[function(a,b){b.exports={loadGeoData:function(a,c){var d,e,f,g,h;f={},h=a.countries;for(g in h)e=h[g],e.countryCode=g,e.countryName=c[g],d=b.exports.convertLatLonToVector(e.lat,e.lon),e.center=d,f[e.countryName]=e;return f},convertLatLonToVector:function(a,b){var c,d,e,f;return d=100,b-=90,c=Math.PI/2-a*Math.PI/180-.01*Math.PI,e=2*Math.PI-b*Math.PI/180+.06*Math.PI,f=new THREE.Vector3,f.x=Math.sin(c)*Math.cos(e)*d,f.y=Math.cos(c)*d,f.z=Math.sin(c)*Math.sin(e)*d,f}}},{}],7:[function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;k=a("./dataloading"),p=a("./mousekeyboard"),z=a("./visualize"),l=a("./geopins"),i=a("./constants"),b=a("./components/legend"),c=a("./components/progress"),o=document.getElementById("visualization"),r=document.getElementById("visualization"),m=document.getElementById("glContainer"),v=null,u=null,w=null,h=null,y=null,s=null,d=null,e=null,f=null,j=0,q=5,x=function(){return window.setInterval(function(){var a;a=j+5,a>f.length&&(a=f.length),z.initVisualization(f.slice(j,a)),s.handleProgressUpdate(a/f.length),j=(j+5)%f.length},500)},n=function(){var a,b,c,d,e,f;return w=new THREE.Scene,w.matrixAutoUpdate=!1,a=new THREE.SpotLight(15658734,3),a.position.x=730,a.position.y=520,a.position.z=626,a.castShadow=!0,w.add(a),b=new THREE.SpotLight(15658734,1.5),b.position.x=-730,b.position.y=520,b.position.z=626,b.castShadow=!0,w.add(b),c=new THREE.PointLight(2236962,14.8),c.position.x=0,c.position.y=-750,c.position.z=0,w.add(c),v=new THREE.Object3D,w.add(v),d=new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("images/map_outline.png")}),e=new THREE.Mesh(new THREE.SphereGeometry(100,40,40),d),e.doubleSided=!1,e.rotation.x=Math.PI,e.rotation.y=-Math.PI/2,e.rotation.z=Math.PI,e.id="base",v.add(e),y=new THREE.Object3D,v.add(y),u=new THREE.WebGLRenderer({antialias:!1,alpha:!0}),u.setSize(window.innerWidth,window.innerHeight),u.autoClear=!1,u.sortObjects=!1,u.generateMipmaps=!1,m.appendChild(u.domElement),h=new THREE.PerspectiveCamera(12,window.innerWidth/window.innerHeight,1,2e4),h.position.z=1400,h.position.y=0,w.add(h),o.addEventListener("mousemove",p.onDocumentMouseMove.bind(null,h),!0),o.addEventListener("mousedown",p.onDocumentMouseDown,!0),o.addEventListener("mouseup",p.onDocumentMouseUp,!1),o.addEventListener("click",p.onClick,!0),o.addEventListener("mousewheel",p.onMouseWheel.bind(null,h),!1),o.addEventListener("DOMMouseScroll",function(a){var b;return b=window.event||a,p.onMouseWheel(h,b)},!1),f=THREEx.WindowResize(u,h),p.startAutoRotate()},g=function(){return p.updateRotation(),v.rotation.x=p.rotateX,v.rotation.y=p.rotateY,requestAnimationFrame(g),u.render(w,h)},t=function(){return React.render(React.createElement(b,{types:i.COLOUR_TYPES,clickCallback:z.toggleVisualizationType}),document.getElementById("legend")),s=React.render(React.createElement(c,null),document.getElementById("progress"))},Detector.webgl?(n(),z.initMeshPool(i.MESH_POOL_SIZE,y),t(),k.loadCountryCodes("country_iso3166.json",function(a){return d=a,k.loadWorldPins("country_lat_lon.json",function(a){return e=a,k.loadRandomizedContentData(200,d,function(a){var b;return f=a,b=l.loadGeoData(e,d),z.buildDataVizGeometries(f,b),g(),x()})})})):Detector.addGetWebGLMessage()},{"./components/legend":2,"./components/progress":3,"./constants":4,"./dataloading":5,"./geopins":6,"./mousekeyboard":8,"./visualize":10}],8:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;q=a("./visualize_lines"),f=0,g=0,h=0,i=0,j=0,k=0,d=!1,o=0,l=0,m=0,n=.35*Math.PI/180,p=90*Math.PI/180,c=null,e=new THREEx.KeyboardState,b.exports={rotateX:0,rotateY:0,updateRotation:function(){return null!=l&&null!=m&&(n+=.012*(l-this.rotateX),o+=.012*(m-this.rotateY),Math.abs(l-this.rotateX)<.1&&Math.abs(m-this.rotateY)<.1&&(l=void 0,m=void 0)),this.rotateX+=n,this.rotateY+=o,n*=.98,o*=.98,(d||null!=l)&&(n*=.6,o*=.6),this.rotateX<-p&&(this.rotateX=-p,n*=-.95),this.rotateX>p?(this.rotateX=p,n*=-.95):void 0},onDocumentMouseMove:function(a,b){return h=f,i=g,f=b.clientX-.5*window.innerWidth,g=b.clientY-.5*window.innerHeight,d?e.pressed("shift")===!1?(o+=(f-h)/2*Math.PI/180*.3,n+=(g-i)/2*Math.PI/180*.3):(a.position.x-=.5*(f-h),a.position.y+=.5*(g-i)):void 0},onDocumentMouseDown:function(a){-1===a.target.className.indexOf("noMapDrag")&&(d=!0,j=f,k=g,l=void 0,l=void 0,b.exports.stopAutoRotate())},onDocumentMouseUp:function(){var a;d=!1,a=!1,b.exports.startAutoRotate()},onClick:function(){Math.abs(j-f)>3||Math.abs(k-g)>3},handleMWheel:function(a,b){return b.scale.z+=.1*a,b.scale.z=q.constrain(b.scale.z,.7,5)},onMouseWheel:function(a,c){var d;return d=0,c.wheelDelta?d=c.wheelDelta/120:c.detail&&(d=-c.detail/3),null!=d&&b.exports.handleMWheel(d,a),c.returnValue=!1},startAutoRotate:function(){return c=window.setInterval(function(){return o+=.1*Math.PI/180*.3},100)},stopAutoRotate:function(){return window.clearInterval(c)}}},{"./visualize_lines":11}],9:[function(a,b){THREE.Curve.Utils.createLineGeometry=function(a){var b,c,d,e;for(b=new THREE.Geometry,c=0,d=a.length;d>c;c++)e=a[c],b.vertices.push(e);return b},b.exports={wrap:function(a,b,c){for(c-=b;b>a;)a+=c;return a%c},screenXY:function(a,b){var c,d,e,f,g;return d=new THREE.Projector,f=d.projectVector(a.clone(),b),e={},g=window.innerWidth,c=1280,c>g&&(g=c),e.x=Math.round(f.x*(g/2))+g/2,e.y=Math.round((0-f.y)*(window.innerHeight/2))+window.innerHeight/2,e}}},{}],10:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;for(i=a("./constants"),o=a("./visualize_lines"),n=new THREE.Vector3(0,0,0),f=[],h={},l=i.COLOUR_TYPES,j=0,k=l.length;k>j;j++)m=l[j],h[m]=!0;b.exports={buildDataVizGeometries:function(a,b){var c,d,e,f,g,h,i,j,k;for(j=document.getElementById("loading"),c=0,h=0,i=a.length;i>h;h++)k=a[h],e=k.src.toUpperCase(),g=k.dest.toUpperCase(),d=b[e],f=b[g],null!=d&&null!=f&&(k.lineGeometry=o.makeConnectionLineGeometry(d,f));j.style.display="none"},initMeshPool:function(a,b){var d,e,g,h;for(h=[],d=e=0,g=a;g>=0?g>e:e>g;d=g>=0?++e:--e)h.push(f.push(new c(b)));return h},initParticleViz:function(a){return null==a.lineGeometry?null:h[a.colour]?e(function(b){var c,e,f,g,h,j,k,l;for(c=d(a.colour),b.linesGeo.merge(a.lineGeometry),j=a.lineGeometry.vertices,h=j[0],g=h.clone(),g.moveIndex=0,g.nextIndex=1,g.lerpN=0,g.path=j,b.particlesGeo.vertices.push(g),b.attributes.alpha.value.push(1),b.attributes.customColor.value.push(c),f=e=1,k=i.NUM_TRAIL_PARTICLES;k>=1?k>=e:e>=k;f=k>=1?++e:--e)l=g.clone(),l.moveIndex=0,l.nextIndex=1,l.lerpN=-1*i.PARTICLE_SPEED*f,l.path=j,b.particlesGeo.vertices.push(l),b.attributes.alpha.value.push(1-i.TRAIL_OPACITY_MULTIPLIER*f),b.attributes.customColor.value.push(c);return b.explosionSphere.material.color=c,b.attributes.alpha.needsUpdate=!0,b.attributes.customColor.needsUpdate=!0,b.vizMesh.add(b.splineOutline),b.startParticleUpdates()}):null},initVisualization:function(a){var c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(b.exports.initParticleViz(c));return f},toggleVisualizationType:function(a,b){return h[a]=b}},e=function(a){return f.length>0?a(f.shift()):window.setTimeout(e,500,a)},g=function(a){return a.linesGeo.vertices=[],a.particlesGeo.vertices=[],a.pSystem.systemComplete=!1,a.explosionSphere.complete=!1,a.explosionSphere.innerRadius=1,a.explosionSphere.outerRadius=2,a.explosionSphere.material.opacity=1,a.attributes.alpha.value=[],a.attributes.customColor.value=[],window.clearInterval(a.particleUpdateId),window.clearInterval(a.explosionUpdateId),a.vizMesh.remove(a.splineOutline),a.vizMesh.remove(a.explosionSphere),f.push(a)},d=function(a){var b;return b=i.COLOUR_MAP[a],b||(b=i.COLOUR_MAP.r),b},c=function(){function a(a){var b,c;this.vizMesh=a,this.particleUpdateId=null,this.explosionUpdateId=null,this.linesGeo=new THREE.Geometry,this.particlesGeo=new THREE.Geometry,this.lineMat=new THREE.LineBasicMaterial({color:16777215,opacity:0,blending:THREE.AdditiveBlending,transparent:!0,depthWrite:!1,vertexColors:!1,linewidth:1}),this.splineOutline=new THREE.Line(null,this.lineMat),this.attributes={alpha:{type:"f",value:[]},customColor:{type:"c",value:[]}},this.uniforms={color:{type:"c",value:new THREE.Color(16777215)},texture:{type:"t",value:THREE.ImageUtils.loadTexture("images/particleB.png")}},this.shaderMaterial=new THREE.ShaderMaterial({uniforms:this.uniforms,attributes:this.attributes,vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!0,depthWrite:!1}),this.pSystem=new THREE.PointCloud(this.particlesGeo,this.shaderMaterial),this.splineOutline.renderDepth=!1,this.pSystem.dynamic=!0,this.pSystem.systemComplete=!1,this.splineOutline.add(this.pSystem),this.splineOutline.geometry=this.linesGeo,c=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:1,side:THREE.BackSide}),b=new THREE.RingGeometry(1,2,32),this.explosionSphere=new THREE.Mesh(b,c),this.explosionSphere.complete=!1,this.explosionSphere.innerRadius=1,this.explosionSphere.outerRadius=2,this.explosionSphere.update=function(){if(!this.complete){if(this.visible||(this.visible=!0),this.innerRadius>10)return this.complete=!0,this.visible=!1,this.innerRadius=1,this.outerRadius=2,void this.dispatchEvent({type:"ExplosionComplete"});this.innerRadius+=2*i.PARTICLE_SPEED,this.outerRadius+=2*i.PARTICLE_SPEED,this.geometry.dispose(),this.geometry=new THREE.RingGeometry(this.innerRadius,this.outerRadius,32),this.material.opacity-=.05}},this.pSystem.addEventListener("ParticleSystemComplete",this.runExplosion.bind(this)),this.explosionSphere.addEventListener("ExplosionComplete",g.bind(this,this)),this.pSystem.update=function(){var a,b,c,d,e,f,g;if(!this.systemComplete)for(this.visible||(this.visible=!0),g=this.geometry.vertices,b=0,c=g.length;c>b;b++){if(e=g[b],f=e.path,e.lerpN+=i.PARTICLE_SPEED,e.lerpN>1&&(e.lerpN=0,e.moveIndex=e.nextIndex,e.nextIndex++,e.nextIndex>=f.length))return e.moveIndex=0,e.nextIndex=0,this.systemComplete=!0,this.visible=!1,void this.dispatchEvent({type:"ParticleSystemComplete"});a=f[e.moveIndex],d=f[e.nextIndex],e.copy(a),e.lerp(d,e.lerpN),this.geometry.verticesNeedUpdate=!0}}}return a.prototype.runExplosion=function(){var a,b,c;return c=this.particlesGeo.vertices[0].path,b=c[c.length-2],a=this.attributes.customColor.value[0].getHex(),this.explosionSphere.position.set(b.x,b.y,b.z),this.explosionSphere.lookAt(n),this.explosionUpdateId=window.setInterval(this.explosionSphere.update.bind(this.explosionSphere),16),this.vizMesh.add(this.explosionSphere)},a.prototype.startParticleUpdates=function(){return this.particleUpdateId=window.setInterval(this.pSystem.update.bind(this.pSystem),16)},a}()},{"./constants":4,"./visualize_lines":11}],11:[function(a,b){var c,d;c=1e3,d=new THREE.Vector3(0,0,0),b.exports={makeConnectionLineGeometry:function(a,b){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return null==a.countryName||null==b.countryName?void 0:(g=a.center.clone().sub(b.center).length(),e=c+.3*g,s=a.center,i=b.center,k=s.clone().lerp(i,.5),m=k.length(),k.normalize(),k.multiplyScalar(m+.4*g),o=(new THREE.Vector3).subVectors(s,i),o.normalize(),h=.5*g,t=s,n=k.clone().add(o.clone().multiplyScalar(h)),l=k.clone().add(o.clone().multiplyScalar(-h)),j=i,q=new THREE.CubicBezierCurve3(s,t,n,k),r=new THREE.CubicBezierCurve3(k,l,j,i),u=2*Math.floor(.02*g+6),p=q.getPoints(u),p=p.splice(0,p.length-1),p=p.concat(r.getPoints(u)),p.push(d),f=THREE.Curve.Utils.createLineGeometry(p))},constrain:function(a,b,c){return b>a?a=b:a>c&&(a=c),a}}},{}],12:[function(a,b){"use strict";var c={linear:function(a,b,c,d){var e=c-b;return a*e/d+b},easeInQuad:function(a,b,c,d){var e=c-b;return e*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){var e=c-b;return-e*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){var e=c-b;return(a/=d/2)<1?e/2*a*a+b:-e/2*(--a*(a-2)-1)+b},easeInElastic:function(a,b,c,d){var e=c-b,f=1.70158,g=0,h=e;if(0==a)return b;if(1==(a/=d))return b+e;if(g||(g=.3*d),h<Math.abs(e)){h=e;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(e/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/g))+b},easeOutElastic:function(a,b,c,d){var e=c-b,f=1.70158,g=0,h=e;if(0==a)return b;if(1==(a/=d))return b+e;if(g||(g=.3*d),h<Math.abs(e)){h=e;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(e/h);return h*Math.pow(2,-10*a)*Math.sin(2*(a*d-f)*Math.PI/g)+e+b},easeInOutElastic:function(a,b,c,d){var e=c-b,f=1.70158,g=0,h=e;if(0==a)return b;if(2==(a/=d/2))return b+e;if(g||(g=.3*d*1.5),h<Math.abs(e)){h=e;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(e/h);return 1>a?-.5*h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/g)+b:h*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/g)*.5+e+b},easeInBack:function(a,b,c,d,e){var f=c-b;return void 0==e&&(e=1.70158),f*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){var f=c-b;return void 0==e&&(e=1.70158),f*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){var f=c-b;return void 0==e&&(e=1.70158),(a/=d/2)<1?f/2*a*a*(((e*=1.525)+1)*a-e)+b:f/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeInBounce:function(a,b,d,e){var f=d-b;return f-c.easeOutBounce(e-a,0,f,e)+b},easeOutBounce:function(a,b,c,d){var e=c-b;return(a/=d)<1/2.75?7.5625*e*a*a+b:2/2.75>a?e*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?e*(7.5625*(a-=2.25/2.75)*a+.9375)+b:e*(7.5625*(a-=2.625/2.75)*a+.984375)+b},easeInOutBounce:function(a,b,d,e){var f=d-b;return e/2>a?.5*c.easeInBounce(2*a,0,f,e)+b:.5*c.easeOutBounce(2*a-e,0,f,e)+.5*f+b}};b.exports=c},{}],13:[function(a,b){"use strict";function c(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function d(a){return a}var e=a("./easingTypes"),f="ADDITIVE",g=e.easeInOutQuad,h=300,i=0,j={easingTypes:e,stackBehavior:{ADDITIVE:"ADDITIVE",DESTRUCTIVE:"DESTRUCTIVE"}};j.Mixin={getInitialState:function(){return{tweenQueue:[]}},tweenState:function(a,b,c){"string"==typeof a&&(c=b,b=a,a=d),this._tweenState(a,b,c)},_tweenState:function(a,b,d){d=c(d);var e=this._pendingState||this.state,k=a(e);d.stackBehavior=d.stackBehavior||f,d.easing=d.easing||g,d.duration=null==d.duration?h:d.duration,d.beginValue=null==d.beginValue?k[b]:d.beginValue,d.delay=null==d.delay?i:d.delay;var l=e.tweenQueue;d.stackBehavior===j.stackBehavior.DESTRUCTIVE&&(l=e.tweenQueue.filter(function(a){return a.stateName!==b||a.stateRefFunc(e)!==k})),l.push({stateRefFunc:a,stateName:b,config:d,initTime:Date.now()+d.delay}),k[b]=d.endValue,this.setState({tweenQueue:l}),1===l.length&&this.startRaf()},getTweeningValue:function(a,b){return"string"==typeof a&&(b=a,a=d),this._getTweeningValue(a,b)},_getTweeningValue:function(a,b){for(var c=this.state,d=a(c),e=d[b],f=Date.now(),g=0;g<c.tweenQueue.length;g++){var h=c.tweenQueue[g],i=h.stateRefFunc(c);if(h.stateName===b&&i===d){var j=f-h.initTime>h.config.duration?h.config.duration:Math.max(0,f-h.initTime),k=-h.config.endValue+h.config.easing(j,h.config.beginValue,h.config.endValue,h.config.duration);e+=k}}return e},_rafCb:function(){if(this.isMounted()){var a=this.state;if(0!==a.tweenQueue.length){var b=Date.now();a.tweenQueue.forEach(function(a){b-a.initTime>=a.config.duration&&a.config.onEnd&&a.config.onEnd()});var c=a.tweenQueue.filter(function(a){return b-a.initTime<a.config.duration});this.setState({tweenQueue:c}),requestAnimationFrame(this._rafCb)}}},startRaf:function(){requestAnimationFrame(this._rafCb)}},b.exports=j},{"./easingTypes":12}]},{},[1,2,3,4,5,6,7,8,9,10,11]);